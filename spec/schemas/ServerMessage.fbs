include "./RealtimeSession.fbs";

attribute "fs_serializer";

namespace fbs.server;

table ServerHello {
  heartbeat_interval_ms:long;

  ratelimit_messages_per_sec:ulong;
  ratelimit_messages_per_min:ulong;
  ratelimit_bytes_per_sec:ulong;
  ratelimit_bytes_per_min:ulong;
}

table ServerHeartbeat {
  heartbeat_interval_ms:long;
}

table GlobalMessage {
  title:string;
  body:string;
}

union ServerMessageBody {
  hello:ServerHello,
  heartbeat:ServerHeartbeat,

  realtime_session:realtime.RealtimeSession,

  message_global:GlobalMessage
}

table ServerMessage (fs_serializer) {
  timestamp:long;
  message:ServerMessageBody;
}

root_type ServerMessage;